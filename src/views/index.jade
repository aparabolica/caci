section#dossies(ng-show='dossiers.length' ng-class='{collapsed: initialized, "in-case": isCase}')
  h2 DossiÃªs
  ul.dossie-list
    li(ng-repeat='dossier in dossiers')
      .image(style='background-image:url({{dossier.featured_image.attachment_meta.sizes.large.url}});')
      article
        h3
          a(ui-sref='home.dossier({id: dossier.ID})') {{dossier.title}}

section#content(autoscroll='false')
  section#casos(ng-class='{collapsed: isDossier, "in-case": isCase}')
    form#casos-filters(ng-show='initialized')
      input(type='text' ng-model='filter.text' placeholder='Digite sua busca')
      div(range-slider min='1986' max='2015' model-max='filter.date.max' model-min='filter.date.min' show-values="true")
      h2.results-count {{filtered.length}} casos encontrados
    ul.caso-list(ng-show='casos.length && initialized')
      li.clearfix(ng-repeat='caso in filtered = (casos | filter:filter.text | dateFilter:filter.date) | limitTo:100')
        article
          .location
            span.icon.icon-pin
            p.location-info
              a(ng-click="focusMap(caso)" href="javascript:void(0);" ng-bind-html='caso | caseLocation')
          header.caso-header
            h3
              a(ui-sref="home.case({id: caso.ID})"){{caso | casoName}}
            .header-meta
              .age.meta(ng-show='caso.idade')
                span.icon.icon-chevron-small-right
                p {{caso.idade}} anos
              .village.meta(ng-show='caso.aldeia')
                span.icon.icon-home
                p {{caso.aldeia}}
              .date.meta
                span.icon.icon-calendar
                p.date-info(ng-bind-html='caso | casoDate')
          p {{caso.descricao}}
          p.report(ng-show='caso.relatorio') {{caso.relatorio}}

.map-container(ng-class='{full: isDossier, "in-case": isCase}')
  map#map(map-data='mapData' markers='filtered | postToMarker')
  
div(ui-view)
